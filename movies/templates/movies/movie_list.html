{% extends 'base.html' %}
{% block content %}

<h1>üé¨ –§–∏–ª—å–º—ã</h1>

<form method="get" style="margin-bottom:20px;">

<input name="q" placeholder="–ü–æ–∏—Å–∫" value="{{ q }}">

<select name="genre">
  <option value="">–í—Å–µ –∂–∞–Ω—Ä—ã</option>
  {% for g in genres %}
    <option value="{{ g.id }}" {% if g.id|stringformat:"s" == selected_genre %}selected{% endif %}>
      {{ g.name }}
    </option>
  {% endfor %}
</select>

<select name="sort">
  <option value="">–ü–æ –¥–∞—Ç–µ</option>
  <option value="rating" {% if sort == 'rating' %}selected{% endif %}>–ü–æ —Ä–µ–π—Ç–∏–Ω–≥—É</option>
</select>

<button>–ù–∞–π—Ç–∏</button>

<a href="{% url 'movie_create' %}">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å–º</a>

</form>

<div style="display:flex;flex-wrap:wrap;gap:20px;">

{% for movie in page_obj %}
<div style="border:1px solid #ccc;padding:10px;width:200px;">
{% if movie.poster %}
<img src="{{ movie.poster.url }}" width="180">
{% endif %}
<h3><a href="{% url 'movie_detail' movie.id %}">{{ movie.title }}</a></h3>
<p>{{ movie.year }}</p>
<p>‚≠ê {{ movie.rating }}</p>
</div>
{% endfor %}

</div>

<br>

<div>
{% if page_obj.has_previous %}
  <a href="?page={{ page_obj.previous_page_number }}&q={{ q }}&genre={{ selected_genre }}&sort={{ sort }}">‚¨Ö</a>
{% endif %}

<span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}</span>

{% if page_obj.has_next %}
  <a href="?page={{ page_obj.next_page_number }}&q={{ q }}&genre={{ selected_genre }}&sort={{ sort }}">‚û°</a>
{% endif %}
</div>

{% endblock %}
